<div x-data="dashboardController()" x-init="init()">
    
    <!-- HEADER: TITLE & FILTER -->
    <div class="flex flex-col md:flex-row justify-between items-end mb-6">
        <div>
            <h2 class="text-2xl font-bold text-gray-800">Xin ch√†o, Admin üëã</h2>
            <p class="text-sm text-gray-500">ƒê√¢y l√† t√¨nh h√¨nh kinh doanh</p>
        </div>
        <div class="mt-4 md:mt-0">
            <select x-model="revenuePeriod" @change="updateRevenue()" class="bg-white border border-gray-200 text-gray-700 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 shadow-sm">
                <option value="day">H√¥m nay</option>
                <option value="week">Tu·∫ßn n√†y</option>
                <option value="month">Th√°ng n√†y</option>
            </select>
        </div>
    </div>

<!-- 1. KPI CARDS (REFINED) -->
<div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">

    <!-- Revenue Card -->
    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-[11px] font-medium text-gray-400 uppercase tracking-wide">T·ªïng doanh thu</p>
                <h3 class="text-2xl font-extrabold text-gray-800 mt-1"
                    x-text="revenue.toLocaleString() + 'ƒë'"></h3>
            </div>
            <div class="w-10 h-10 flex items-center justify-center rounded-full bg-blue-50 text-blue-600">
                <i class="fas fa-wallet"></i>
            </div>
        </div>

        <div class="mt-3 flex items-center gap-2 text-xs">
            <span class="flex items-center gap-1 text-green-600 font-semibold">
                <i class="fas fa-arrow-up text-[10px]"></i> 12.5%
            </span>
            <span class="text-gray-400">so v·ªõi k·ª≥ tr∆∞·ªõc</span>
        </div>
    </div>

    <!-- Orders Card -->
    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-[11px] font-medium text-gray-400 uppercase tracking-wide">ƒê∆°n m·ªõi</p>
                <h3 class="text-2xl font-extrabold text-gray-800 mt-1">24</h3>
            </div>
            <div class="w-10 h-10 flex items-center justify-center rounded-full bg-purple-50 text-purple-600">
                <i class="fas fa-shopping-bag"></i>
            </div>
        </div>

        <div class="mt-3 flex items-center gap-2 text-xs">
            <span class="flex items-center gap-1 text-red-600 font-semibold">
                <i class="fas fa-arrow-down text-[10px]"></i> 2.1%
            </span>
            <span class="text-gray-400">so v·ªõi k·ª≥ tr∆∞·ªõc</span>
        </div>
    </div>

    <!-- Visitors Card -->
    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-[11px] font-medium text-gray-400 uppercase tracking-wide">Kh√°ch truy c·∫≠p</p>
                <h3 class="text-2xl font-extrabold text-gray-800 mt-1"
                    x-text="visitorCount"></h3>
            </div>
            <div class="w-10 h-10 flex items-center justify-center rounded-full bg-green-50 text-green-600">
                <i class="fas fa-users"></i>
            </div>
        </div>

        <div class="mt-3 flex items-center gap-2 text-xs">
            <span class="flex items-center gap-1 text-green-600 font-semibold">
                <i class="fas fa-arrow-up text-[10px]"></i> 5.4%
            </span>
            <span class="text-gray-400">so v·ªõi k·ª≥ tr∆∞·ªõc</span>
        </div>
    </div>

    <!-- Pending Orders Card (ALERT) -->
    <div class="bg-orange-50 p-4 rounded-xl border border-orange-200 hover:shadow-md transition cursor-pointer"
         @click="$store.app.setTab('orders')">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-[11px] font-semibold text-orange-500 uppercase tracking-wide">
                    Ch·ªù x·ª≠ l√Ω
                </p>
                <h3 class="text-2xl font-extrabold text-orange-600 mt-1"
                    x-text="pendingCount"></h3>
            </div>
            <div class="w-10 h-10 flex items-center justify-center rounded-full bg-orange-100 text-orange-600">
                <i class="fas fa-clock"></i>
            </div>
        </div>

        <div class="mt-3 text-xs font-semibold text-orange-600">
            ‚ö† C·∫ßn x·ª≠ l√Ω ngay
        </div>
    </div>

</div>
    <!-- 2. MAIN CHART AREA -->
    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 mb-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="font-bold text-gray-800">Bi·ªÉu ƒë·ªì doanh thu</h3>
            <button class="text-gray-400 hover:text-blue-600"><i class="fas fa-expand-alt"></i></button>
        </div>
        <div class="h-64 w-full">
            <canvas id="revenueChart"></canvas>
        </div>
    </div>

    <!-- 3. SPLIT VIEW: TASKS & TOP PRODUCTS -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        
        <!-- Left: Urgent Tasks -->
        <div class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-gray-800">Vi·ªác c·∫ßn l√†m</h3>
                <span class="bg-red-100 text-red-600 text-xs font-bold px-2 py-1 rounded-full" x-text="urgentTasks.length"></span>
            </div>
            
            <div class="space-y-3">
                <template x-for="task in urgentTasks" :key="task.id">
                    <div class="p-3 bg-yellow-50 border border-yellow-100 rounded-xl hover:bg-yellow-100 transition cursor-pointer">
                        <div class="flex justify-between items-start mb-1">
                            <span class="text-xs font-bold text-yellow-700 bg-yellow-200 px-1.5 rounded" x-text="task.id"></span>
                            <span class="text-[10px] text-yellow-600" x-text="task.time"></span>
                        </div>
                        <p class="text-sm font-medium text-gray-800 mb-1">Duy·ªát ƒë∆°n h√†ng m·ªõi</p>
                        <div class="flex justify-between items-end text-xs">
                            <span class="text-gray-500" x-text="task.email"></span>
                            <span class="font-bold text-blue-600" x-text="task.total.toLocaleString()+'ƒë'"></span>
                        </div>
                    </div>
                </template>
                
                <div x-show="urgentTasks.length === 0" class="text-center py-8 text-gray-400">
                    <i class="fas fa-check-circle text-3xl text-green-400 mb-2"></i>
                    <p class="text-sm">M·ªçi th·ª© ƒë·ªÅu ·ªïn!</p>
                </div>
            </div>
            
            <button @click="$store.app.setTab('orders')" class="w-full mt-4 py-2 text-sm text-blue-600 font-bold bg-blue-50 rounded-lg hover:bg-blue-100 transition">
                Xem t·∫•t c·∫£ ƒë∆°n h√†ng
            </button>
        </div>

        <!-- Right: Top Products -->
        <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
            <h3 class="font-bold text-gray-800 mb-4">Top S·∫£n ph·∫©m b√°n ch·∫°y</h3>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left">
                    <thead class="text-xs text-gray-500 uppercase bg-gray-50">
                        <tr>
                            <th class="px-4 py-3 rounded-l-lg">S·∫£n ph·∫©m</th>
                            <th class="px-4 py-3 text-center">ƒê√£ b√°n</th>
                            <th class="px-4 py-3 text-right rounded-r-lg">Doanh thu</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                        <template x-for="prod in topProducts" :key="prod.name">
                            <tr class="hover:bg-gray-50 transition">
                                <td class="px-4 py-3">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg bg-gray-100 p-1 border border-gray-200">
                                            <img :src="prod.image" class="w-full h-full object-contain">
                                        </div>
                                        <span class="font-medium text-gray-800" x-text="prod.name"></span>
                                    </div>
                                </td>
                                <td class="px-4 py-3 text-center">
                                    <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded-md text-xs font-bold" x-text="prod.sales"></span>
                                </td>
                                <td class="px-4 py-3 text-right font-bold text-gray-700" x-text="prod.revenue.toLocaleString()+'ƒë'"></td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>